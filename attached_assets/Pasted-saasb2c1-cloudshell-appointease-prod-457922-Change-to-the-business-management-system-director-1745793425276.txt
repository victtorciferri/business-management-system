saasb2c1@cloudshell:~ (appointease-prod-457922)$ # Change to the business management system directory
cd ~/business-management-system

# Restore the original package.json
cp package.json.original package.json

# Create a simple app.yaml for App Engine deployment
cat > app.yaml << 'EOF'
runtime: nodejs20

env_variables:
  NODE_ENV: "production"

handlers:
  - url: /.*
    secure: always
    redirect_http_response_code: 301
    script: auto
EOF

# Install the App Engine Node.js dependencies locally
npm install

# Deploy to App Engine
gcloud app deploy --quiet

up to date, audited 759 packages in 3s

112 packages are looking for funding
  run `npm fund` for details

5 moderate severity vulnerabilities

To address all issues (including breaking changes), run:
  npm audit fix --force

Run `npm audit` for details.
WARNING: You might be using automatic scaling for a standard environment deployment, without providing a value for automatic_scaling.max_instances. Starting from March, 2025, App Engine sets the automatic scaling maximum instances default for standard environment deployments to 20. This change doesn't impact existing apps. To override the default, specify the new max_instances value in your app.yaml file, and deploy a new version or redeploy over an existing version. For details on max_instances, see https://cloud.google.com/appengine/docs/standard/reference/app-yaml.md#scaling_elements. 

ERROR: (gcloud.app.deploy) The current Google Cloud project [appointease-prod-457922] does not contain an App Engine application. Use `gcloud app create` to initialize an App Engine application within the project.
saasb2c1@cloudshell:~/business-management-system (appointease-prod-457922)$ # Change to the business management system directory
cd ~/business-management-system

# Make sure we're using the original package.json
if [ -f package.json.original ]; then
  cp package.json.original package.json
fi

# Create an app.yaml file for App Engine deployment
cat > app.yaml << 'EOF'
runtime: nodejs20

env_variables:
  NODE_ENV: "production"

# Include DATABASE_URL from the secret manager
includes:
  - env_variables.yaml

handlers:
  - url: /.*
    secure: always
    redirect_http_response_code: 301
    script: auto
EOF

# Create a separate file for the database URL that will be populated from the secret
cat > env_variables.yaml << EOF
env_variables:
  DATABASE_URL: "$(echo $DATABASE_URL)"
EOF

# Make sure you have the gcloud app component installed
gcloud components install app-engine-nodejs --quiet

# Initialize an App Engine app in your region if it doesn't exist
gcloud app deploy --quietn=southamerica-west1
ERROR: (gcloud.components.install) "app-engine-nodejs" are not valid component name(s).

You are creating an app for project [appointease-prod-457922].
WARNING: Creating an App Engine application for a project is irreversible and the region
cannot be changed. More information about regions is at
<https://cloud.google.com/appengine/docs/locations>.

WARNING: Starting from March, 2025, App Engine sets the automatic scaling maximum instances
default for standard environment deployments to 20. This change doesn't impact
existing apps. To override the default, specify the new max_instances value in your
app.yaml file, and deploy a new version or redeploy over an existing version.
For more details on max_instances, see
<https://cloud.google.com/appengine/docs/standard/reference/app-yaml.md#scaling_elements>.

ERROR: (gcloud.app.create) INVALID_ARGUMENT: Invalid location
WARNING: You might be using automatic scaling for a standard environment deployment, without providing a value for automatic_scaling.max_instances. Starting from March, 2025, App Engine sets the automatic scaling maximum instances default for standard environment deployments to 20. This change doesn't impact existing apps. To override the default, specify the new max_instances value in your app.yaml file, and deploy a new version or redeploy over an existing version. For details on max_instances, see https://cloud.google.com/appengine/docs/standard/reference/app-yaml.md#scaling_elements. 

ERROR: (gcloud.app.deploy) The current Google Cloud project [appointease-prod-457922] does not contain an App Engine application. Use `gcloud app create` to initialize an App Engine application within the project.