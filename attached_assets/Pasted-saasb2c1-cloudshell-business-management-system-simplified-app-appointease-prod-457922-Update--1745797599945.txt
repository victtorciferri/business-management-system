saasb2c1@cloudshell:~/business-management-system/simplified-app (appointease-prod-457922)$ # Update the Dockerfile to remove the PORT environment variable
cat > Dockerfile << 'EOF'
FROM node:20-slim

WORKDIR /app

COPY package.json .
RUN npm install

COPY . .

EXPOSE 8080

CMD ["node", "index.js"]
EOF

# Deploy again without setting the PORT environment variable
gcloud run deploy appointease \
  --source . \
  --region=southamerica-west1 \
  --platform=managed \
  --allow-unauthenticated \
  --set-env-vars="NODE_ENV=production" \
  --update-secrets="DATABASE_URL=database-url:latest"
Building using Dockerfile and deploying container to Cloud Run service [appointease] in project [appointease-prod-457922] region [southamerica-west1]
/  Building and deploying... Uploading sources.                                                                                                                                             
  /  Uploading sources...                                                                                                                                                                   
OK Building and deploying... Done.                                                                                                                                                          
  OK Uploading sources...                                                                                                                                                                   
  OK Building Container... Logs are available at [https://console.cloud.google.com/cloud-build/builds;region=southamerica-west1/d622b863-2894-46f1-b52a-5b82649b5cbf?project=249754346416]. 
  OK Creating Revision...                                                                                                                                                                   
  OK Routing traffic...                                                                                                                                                                     
  OK Setting IAM Policy...                                                                                                                                                                  
Done.                                                                                                                                                                                       
Service [appointease] revision [appointease-00035-jzg] has been deployed and is serving 100 percent of traffic.
Service URL: https://appointease-249754346416.southamerica-west1.run.app
saasb2c1@cloudshell:~/business-management-system/simplified-app (appointease-prod-457922)$ 