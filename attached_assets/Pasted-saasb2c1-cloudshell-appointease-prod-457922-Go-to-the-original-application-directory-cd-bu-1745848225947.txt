saasb2c1@cloudshell:~ (appointease-prod-457922)$ # Go to the original application directory
cd ~/business-management-system/appointease

# Create a new start.sh script at the root of the project
cat > start.sh << 'EOF'
#!/bin/bash
echo "Starting Cloud SQL Auth Proxy..."
cloud_sql_proxy -instances=$CLOUD_SQL_CONNECTION_NAME=tcp:5432 &
echo "Waiting for proxy to initialize..."
sleep 10
echo "Starting AppointEase..."
node server/index.js
EOF
chmod +x start.sh

# Create a Dockerfile that preserves the entire application structure
cat > Dockerfile << 'EOF'
FROM node:20

# Install the Cloud SQL Auth Proxy
RUN apt-get update && apt-get install -y wget
RUN wget https://dl.google.com/cloudsql/cloud_sql_proxy.linux.amd64 -O /usr/local/bin/cloud_sql_proxy
RUN chmod +x /usr/local/bin/cloud_sql_proxy

WORKDIR /app

# Copy the entire application
COPY . .

# Install dependencies
RUN npm install

# Make the start script executable
RUN chmod +x start.sh

EXPOSE 8080
CMD ["./start.sh"]
  --add-cloudsql-instances=${INSTANCE_CONNECTION_NAME}tgresql://postgres:AppointEase123!@localhost:5432/postgres,CLOUD_SQL_CONNECTION_NAME=${INSTANCE_CONNECTION_NAME}" \
-bash: cd: /home/saasb2c1/business-management-system/appointease: No such file or directory
Your active configuration is: [cloudshell-31312]
-bash: !@localhost: event not found
Building using Dockerfile and deploying container to Cloud Run service [appointease] in project [appointease-prod-457922] region [southamerica-west1]
/  Building and deploying... Uploading sources.                                                                                                                                             
/  Building and deploying... Uploading sources.                                                                                                                                             
X  Building and deploying... Building Container.                                                                                                                                            
  OK Uploading sources...                                                                                                                                                                   
  OK Building Container... Logs are available at [https://console.cloud.google.com/cloud-build/builds;region=southamerica-west1/3bcbaab2-c5e8-48f5-834e-f7594a5ce9bf?project=249754346416]. 
  -  Creating Revision...                                                                                                                                                                   
Creating temporary archive of 33292 file(s) totalling 1.0 GiB before compression.
  OK Setting IAM Policy...                                                                                                                                                                  
Deployment failed                                                                                                                                                                           
ERROR: (gcloud.run.deploy) Revision 'appointease-00061-n6j' is not ready and cannot serve traffic. The user-provided container failed to start and listen on the port defined provided by the PORT=8080 environment variable within the allocated timeout. This can happen when the container port is misconfigured or if the timeout is too short. The health check timeout can be extended. Logs for this revision might contain more information.

Logs URL: https://console.cloud.google.com/logs/viewer?project=appointease-prod-457922&resource=cloud_run_revision/service_name/appointease/revision_name/appointease-00061-n6j&advancedFilter=resource.type%3D%22cloud_run_revision%22%0Aresource.labels.service_name%3D%22appointease%22%0Aresource.labels.revision_name%3D%22appointease-00061-n6j%22 
For more troubleshooting guidance, see https://cloud.google.com/run/docs/troubleshooting#container-failed-to-start
saasb2c1@cloudshell:~ (appointease-prod-457922)$ 